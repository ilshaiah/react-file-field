!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=c(e);if(t){var r=c(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return l(this,a)}}function l(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}a.r(t),a.d(t,"FileField",(function(){return u})),a.d(t,"MultipleFileField",(function(){return y}));var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,React.Component);var t,a,n,l=o(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=l.call(this,e)).state={uploading:!1,doneUploading:!1,fileName:"",progress:0,readOnly:!1},t.isCompMounted=!1,t.changeValue=t.changeValue.bind(s(t)),t.clickHandler=t.clickHandler.bind(s(t)),t.changeFieldHandler=t.changeFieldHandler.bind(s(t)),t.removeFile=t.removeFile.bind(s(t)),t.dropAreaRef=React.createRef(),t.fileFieldRef=React.createRef(),t}return t=c,(a=[{key:"changeValue",value:function(e){this.props.onChange(this.props.name,e)}},{key:"clickHandler",value:function(){jQuery(this.fileFieldRef.current).trigger("click")}},{key:"setDropHandler",value:function(){var e=this,t=jQuery(this.dropAreaRef.current);t.on("drag dragstart dragend dragover dragenter dragleave drop",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragover dragenter",(function(){t.addClass("drag-over")})).on("dragleave dragend drop",(function(){t.removeClass("drag-over")})).on("drop",(function(t){var a=t.originalEvent.dataTransfer.files;e.upload(a[0])}))}},{key:"changeFieldHandler",value:function(e){this.upload(this.fileFieldRef.current.files[0])}},{key:"removeFile",value:function(){this.changeValue(""),this.setState({uploading:!1,doneUploading:!1,fileName:"",progress:0})}},{key:"render",value:function(){var e="";return""!=this.props.value&&!1===this.state.uploading?e=this.renderFileUploaded():""==this.props.value&&1==this.state.readOnly?e=this.renderNoFileUploaded():""==this.props.value&&!1===this.state.uploading?e=this.renderDragDropArea():!0===this.state.uploading&&(e=this.renderUploadProgress()),React.createElement(React.Fragment,null,React.createElement("input",{type:"file",className:"hidden",ref:this.fileFieldRef,onChange:this.changeFieldHandler}),e)}},{key:"renderFileUploaded",value:function(){return React.createElement("div",{className:"file-uploaded"},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"})),React.createElement("div",{className:"file-name"},React.createElement("a",{className:"file-link",href:this.props.filePath+this.props.value,target:"_blank"},translations.front.browse_file),0==this.state.readOnly&&React.createElement("a",{className:"delete-icon",href:"javascript:void(0);",onClick:this.removeFile},React.createElement("i",{className:"fa fa-times","aria-hidden":"true"}))))}},{key:"renderDragDropArea",value:function(){return React.createElement("div",{className:"drag-drop-area",ref:this.dropAreaRef,onClick:this.clickHandler},React.createElement("div",{className:"file-icon"},React.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"}),React.createElement("span",{className:"file-plus"},React.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}))),React.createElement("div",{className:"instruction"},translations.front.drag_drop_browse_files))}},{key:"renderUploadProgress",value:function(){return React.createElement("div",{className:"file-upload-progress ".concat(!0===this.state.doneUploading?"status-done":"")},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"})),React.createElement("div",{className:"file-name"},this.state.fileName,React.createElement("a",{className:"delete-icon",href:"javascript:void(0);",onClick:this.removeFile},React.createElement("i",{className:"fa fa-times","aria-hidden":"true"}))),React.createElement("div",{className:"upload-progress-bar"},React.createElement("div",{className:"upload-progress",style:{width:this.state.progress+"%"}})))}},{key:"renderNoFileUploaded",value:function(){return React.createElement("div",{className:"file-uploaded"},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"})),React.createElement("div",{className:"file-name"},React.createElement("span",null,translations.front.no_file_uploaded)))}},{key:"upload",value:function(e){this.setState({uploading:!0,doneUploading:!1,fileName:e.name,progress:0});var t=new FormData;t.append("uploads[]",e);var a=this;jQuery.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;a.setState({progress:t})}}),!1),e},url:app_url+"/upload-media",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",cache:!1,contentType:!1,processData:!1,data:t,success:function(e){!0===e[0].success&&(a.setState({doneUploading:!0,progress:100}),setTimeout((function(){a.setState({uploading:!1,doneUploading:!1,fileName:"",progress:0})}),500),a.changeValue(e[0].file_name))}})}},{key:"componentDidMount",value:function(){this.isCompMounted=!0,this.setState({readOnly:void 0!==this.props.readOnly&&this.props.readOnly}),this.setDropHandler()}},{key:"componentDidUpdate",value:function(e,t,a){e.readOnly!==this.props.readOnly&&this.setState({readOnly:void 0!==this.props.readOnly&&this.props.readOnly})}},{key:"componentWillUnmount",value:function(){this.isCompMounted=!1}}])&&r(t.prototype,a),n&&r(t,n),c}();function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=v(e);if(t){var r=v(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return h(this,a)}}function h(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(i,React.Component);var t,a,n,r=m(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=r.call(this,e)).state={files:{},data:{}},t.isCompMounted=!1,t.clickHandler=t.clickHandler.bind(g(t)),t.changeFieldHandler=t.changeFieldHandler.bind(g(t)),t.dropAreaRef=React.createRef(),t.fileFieldRef=React.createRef(),t}return t=i,(a=[{key:"changeValue",value:function(){this.props.onChange(this.props.name,this.state.data)}},{key:"clickHandler",value:function(){jQuery(this.fileFieldRef.current).trigger("click")}},{key:"setDropHandler",value:function(){var e=this,t=jQuery(this.dropAreaRef.current);t.on("drag dragstart dragend dragover dragenter dragleave drop",(function(e){e.preventDefault(),e.stopPropagation()})).on("dragover dragenter",(function(){t.addClass("drag-over")})).on("dragleave dragend drop",(function(){t.removeClass("drag-over")})).on("drop",(function(t){var a=t.originalEvent.dataTransfer.files;e.upload(a)}))}},{key:"changeFieldHandler",value:function(e){this.upload(this.fileFieldRef.current.files)}},{key:"removeFile",value:function(e){var t=Object.assign({},this.state);delete t.files[e],this.setState({files:t.files}),this.changeValue()}},{key:"render",value:function(){var e=[];for(var t in this.state.files)e.push(this.renderUploadProgress(this.state.files[t]));return React.createElement(React.Fragment,null,React.createElement("input",{type:"file",className:"hidden",ref:this.fileFieldRef,onChange:this.changeFieldHandler,multiple:!0}),this.renderDragDropArea(),e)}},{key:"renderDragDropArea",value:function(){return React.createElement("div",{className:"drag-drop-area",ref:this.dropAreaRef,onClick:this.clickHandler},React.createElement("div",{className:"file-icon"},React.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"}),React.createElement("span",{className:"file-plus"},React.createElement("i",{className:"fa fa-plus","aria-hidden":"true"}))),React.createElement("div",{className:"instruction"},translations.front.drag_drop_browse_files))}},{key:"renderUploadProgress",value:function(e){var t=!1===e.doneUploading?this.prepareFileSize(e.uploadedSize)+" "+translations.front.of+" "+this.prepareFileSize(e.size):this.prepareFileSize(e.size),a=!1===e.doneUploading?translations.front.uploading:!0===e.succeedUploading?translations.front.uploaded:translations.front.failed_uploading,n=!1===e.doneUploading?"":!0===e.succeedUploading?"status-done":"status-failed";return React.createElement("div",{className:"p-t-20",key:e.id},React.createElement("div",{className:"file-upload-progress with-bottom-details ".concat(n)},React.createElement("span",{className:"file-icon"},React.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"})),React.createElement("div",{className:"file-name"},e.fileName,React.createElement("a",{className:"delete-icon",href:"javascript:void(0);",onClick:this.removeFile.bind(this,e.id)},React.createElement("i",{className:"fa fa-times","aria-hidden":"true"}))),React.createElement("div",{className:"upload-progress-bar"},React.createElement("div",{className:"upload-progress",style:{width:e.progress+"%"}})),React.createElement("div",{className:"bottom-details"},React.createElement("span",{className:"size"},t),React.createElement("span",{className:"status"},a))))}},{key:"upload",value:function(e){for(var t=Object.assign({},this.state),a=new FormData,n=[],r=0;r<e.length;r++){var i=this.uniqid();a.append("uploads["+i+"]",e[r]),t.files[i]={id:i,doneUploading:!1,succeedUploading:!1,fileName:e[r].name,uploadedFileName:"",progress:0,size:e[r].size,uploadedSize:0}}this.setState({files:t.files});var o=this;jQuery.ajax({xhr:function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;o.changeUploadingProgress(t,n)}}),!1),e},url:app_url+"/upload-media",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},type:"POST",cache:!1,contentType:!1,processData:!1,data:a,success:function(e){o.setUploadingResult(e)}})}},{key:"componentDidMount",value:function(){this.isCompMounted=!0,this.setDropHandler()}},{key:"componentWillUnmount",value:function(){this.isCompMounted=!1}},{key:"uniqid",value:function(){return(new Date).getTime()+""+Math.floor(11111*Math.random())}},{key:"prepareFileSize",value:function(e){return 0==e?"":((e=Math.ceil(e/1024))>=1024&&(e=e%1024>0?new Number(e/1024).toFixed(2):e/1024),e+" KB")}},{key:"changeUploadingProgress",value:function(e,t){for(var a=Object.assign({},this.state),n=0;n<t.length;n++){var r=Object.assign({},a.files[t[n]]);r.progress=e,r.uploadedSize=r.size*(e/100),a.files[t[n]]=r}this.setState({files:a.files})}},{key:"setUploadingResult",value:function(e){var t=Object.assign({},this.state);for(var a in e){var n=Object.assign({},t.files[a]);n.doneUploading=!0,!0===e[a].success?(n.progress=100,n.uploadedSize=n.size,n.succeedUploading=!0,n.uploadedFileName=e[a].file_name,t.data[a]={original_name:e[a].original_name,file_name:e[a].file_name,extension:e[a].extension}):n.succeedUploading=!1,t.files[a]=n}this.setState({files:t.files,data:t.data}),this.changeValue()}}])&&f(t.prototype,a),n&&f(t,n),i}()}]);